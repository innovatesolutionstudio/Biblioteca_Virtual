<!--Cabecera-->
<%- include('../Pagina/cabecera.ejs') %>

<section class="modulo-historico">
  <h2 class="titulo-historico">Evolución Histórica de la Inflación en Bolivia</h2>

  <div class="contenedor-historico">
    <!-- Gráfico principal -->
    <div class="grafico-principal">
      <canvas id="graficoBarra"></canvas>
    </div>

    <!-- Filtros laterales -->
    <aside class="filtros-historicos">
      <form method="GET" action="/Evolucion-Historica-Dashboard" class="filtro">
        <label for="anio">Selecciona un año:</label>
        <select name="anio" id="anio">
          <% aniosDisponibles.forEach(anio => { %>
            <option value="<%= anio %>" <%= anio == anioSeleccionado ? 'selected' : '' %>><%= anio %></option>
          <% }) %>
        </select>
        <button type="submit" class="boton-generar">Generar</button>
      </form>

      <div class="resumen-filtros">
        <p><strong>Seleccionado:</strong></p>
        <ul>
          <li>✅ Año: <%= anioSeleccionado || 'Todos' %></li>
          <li>✅ Pais: Bolivia</li>
        </ul>
      </div>
    </aside>
  </div>

  <!-- Métricas inferiores falsas -->
  <div class="metricas-historicas">
    <div class="metrica">
      <h4>Fake Data 1</h4>
      <canvas id="graficoBarraMini"></canvas>
      <p>Total: <strong>19</strong></p>
    </div>
    <div class="metrica">
      <h4>Fake Data 2</h4>
      <canvas id="graficoDona"></canvas>
      <p><strong>98%</strong> éxito</p>
    </div>
  </div>
</section>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
  // Inyectar los datos del backend
  const datosInflacion = <%- JSON.stringify(datosInflacion) %>;

  // Extraer etiquetas y valores
  const etiquetas = datosInflacion.map(d => d.Year);
  const valores = datosInflacion.map(d => d.Inflation);

  new Chart(document.getElementById('graficoBarra'), {
    type: 'bar',
    data: {
      labels: etiquetas,
      datasets: [
        {
          label: 'Inflación (%)',
          data: valores,
          backgroundColor: '#4caf50'
        }
      ]
    },
    options: {
      responsive: true,
      plugins: {
        legend: { position: 'top' },
        title: {
          display: true,
          text: 'Inflación en Bolivia'
        }
      }
    }
  });
</script>

<!--Pie de página-->
<%- include('../Pagina/footer.ejs') %>
